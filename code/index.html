<html>
    <head>
        <title>wasm-spasm</title>
    </head>
    
    <body>
        <form id="cli" autocomplete="off">
            <select id="fsel">
                <option value="print_parity">print_parity</option>
                <!-- <option value="add32">add32</option> -->
            </select>
            <input id="input" type="text" size="79">
        </form>

        <textarea id="output" rows="35" cols="80"></textarea>
        
    </body>
    

    <script>
    //map names to wasm functions
    let funcs = {};
    let line = ""; //output line buffer

    let cli = document.querySelector("#cli");
    let fsel = document.querySelector("#fsel");
    let input = document.querySelector("#input");
    let output = document.querySelector("#output");

    cli.onsubmit = () => {
        process(input.value);
        input.value = "";
        return false; //don't refresh
    }

    function process(text) {
        //split text into params on single space
        let args = text.split(' ');
        //call selected function on args
        let retval = funcs[fsel.value].apply(null, args);
        if (line != "") output.value = line + '\n' + output.value;
        if (retval != undefined) output.value = retval + '\n' + output.value;
        line = ""; //clear line buffer
    }
    
    </script>

    <script src="main.js"></script>

</html>